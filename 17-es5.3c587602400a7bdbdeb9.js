function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{gMET:function(e,n,t){"use strict";t.r(n),t.d(n,"UserManagementPageModule",(function(){return S}));var o,r=t("ofXK"),i=t("3Pt+"),a=t("TEn/"),s=t("tyNb"),c=t("mrSG"),l=function e(){_classCallCheck(this,e),this.limit=0,this.totalUser=0,this.totalPage=0,this.offset=0,this.searchBy="name",this.orderBy="name",this.isAscending=!0,this.name="",this.email=""},u=t("fXoL"),b=t("/zMi"),h=((o=function(){function e(n,t,o){_classCallCheck(this,e),this.modalController=n,this.userManagementService=t,this.toastController=o,this.user={_id:"",name:"",email:"",role:""}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"dismissModal",value:function(){this.modalController.dismiss()}},{key:"createAcc",value:function(){var e=this;this.userManagementService.createUser(this.user).subscribe((function(){return Object(c.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dismissModal(),e.next=3,this.toastController.create({header:"Create ".concat(this.user.name,"'s account success!"),color:"success",duration:2e3});case 3:e.sent.present();case 4:case"end":return e.stop()}}),e,this)})))}),(function(){return Object(c.a)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastController.create({header:"Fail to create ".concat(this.user.name,"'s account!"),color:"danger",duration:2e3});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e,this)})))}))}}]),e}()).\u0275fac=function(e){return new(e||o)(u.Mb(a.R),u.Mb(b.a),u.Mb(a.Y))},o.\u0275cmp=u.Gb({type:o,selectors:[["app-create-user"]],decls:37,vars:3,consts:[["color","tertiary"],["slot","end"],["shape","round","fill","clear",3,"click"],["name","close"],["name","person","slot","start"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["name","mail","slot","start"],[3,"ngModel","ngModelChange"],["name","ribbon","slot","start"],["interface","popover",3,"ngModel","ngModelChange"],["value","admin"],["value","data manager"],["value","senior data manager"],["lines","none",1,"ion-margin-top"],["slot","end","size","default",3,"click"],["name","save","slot","start"]],template:function(e,n){1&e&&(u.Rb(0,"ion-header"),u.Rb(1,"ion-toolbar",0),u.Rb(2,"ion-title"),u.Ac(3,"Create new account"),u.Qb(),u.Rb(4,"ion-buttons",1),u.Rb(5,"ion-button",2),u.Zb("click",(function(){return n.dismissModal()})),u.Nb(6,"ion-icon",3),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Rb(7,"ion-content"),u.Rb(8,"ion-grid"),u.Rb(9,"ion-row"),u.Rb(10,"ion-col"),u.Rb(11,"ion-item"),u.Nb(12,"ion-icon",4),u.Rb(13,"ion-label",5),u.Ac(14,"Name"),u.Qb(),u.Rb(15,"ion-input",6),u.Zb("ngModelChange",(function(e){return n.user.name=e})),u.Qb(),u.Qb(),u.Rb(16,"ion-item"),u.Nb(17,"ion-icon",7),u.Rb(18,"ion-label",5),u.Ac(19,"Email"),u.Qb(),u.Rb(20,"ion-input",8),u.Zb("ngModelChange",(function(e){return n.user.email=e})),u.Qb(),u.Qb(),u.Rb(21,"ion-item"),u.Nb(22,"ion-icon",9),u.Rb(23,"ion-label"),u.Ac(24,"Role"),u.Qb(),u.Rb(25,"ion-select",10),u.Zb("ngModelChange",(function(e){return n.user.role=e})),u.Rb(26,"ion-select-option",11),u.Ac(27,"Admin"),u.Qb(),u.Rb(28,"ion-select-option",12),u.Ac(29,"Data Manager"),u.Qb(),u.Rb(30,"ion-select-option",13),u.Ac(31,"Senior Data Manager"),u.Qb(),u.Qb(),u.Qb(),u.Rb(32,"ion-item",14),u.Rb(33,"ion-button",15),u.Zb("click",(function(){return n.createAcc()})),u.Nb(34,"ion-icon",16),u.Rb(35,"ion-label"),u.Ac(36,"Create"),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb()),2&e&&(u.Ab(15),u.ic("ngModel",n.user.name),u.Ab(5),u.ic("ngModel",n.user.email),u.Ab(5),u.ic("ngModel",n.user.role))},directives:[a.q,a.N,a.M,a.f,a.e,a.r,a.n,a.p,a.C,a.m,a.t,a.u,a.s,a.X,i.e,i.h,a.E,a.W,a.F],styles:[""]}),o),g=t("KJTt"),d=t("2MiI"),m=t("lDzL"),f=t("LmEr");function p(e,n){if(1&e){var t=u.Sb();u.Rb(0,"ion-item",20),u.Rb(1,"ion-text"),u.Ac(2),u.Qb(),u.Rb(3,"ion-buttons",5),u.Rb(4,"ion-button",21),u.Zb("click",(function(){u.rc(t);var e=n.$implicit;return u.bc().deleteUser(e)})),u.Nb(5,"ion-icon",22),u.Rb(6,"ion-label"),u.Ac(7,"Delete"),u.Qb(),u.Qb(),u.Qb(),u.Qb()}if(2&e){var o=n.$implicit;u.Ab(2),u.Bc(o.name)}}var v,R,C,w=function(){return{name:"Name"}},Q=function(){return{name:"Email"}},y=function(){return{name:"Role",sortable:!1}},M=function(e,n,t){return[e,n,t]},k=[{path:"",component:(v=function(){function e(n,t,o,r,i,a){_classCallCheck(this,e),this.pagePositionService=n,this.userManagementService=t,this.modalController=o,this.alertController=r,this.toastController=i,this.loadingController=a,this.pageAtTop=!0,this.page=new l,this.rows=new Array,this.selected=[],this.searchText="",this.page.limit=5}return _createClass(e,[{key:"ngOnInit",value:function(){this.innerWidth=window.innerWidth,this.setPage({offset:0})}},{key:"onResize",value:function(e){this.innerWidth=window.innerWidth}},{key:"onScroll",value:function(e){this.pageAtTop=this.pagePositionService.isPageAtTop(e)}},{key:"setPage",value:function(e){var n=this;this.presentLoading(),this.page.offset=e.offset,this.userManagementService.getUserList(this.page).subscribe((function(e){n.stopLoading(),n.page.offset=e.offset,n.page.totalUser=e.totalUser,n.page.totalPage=e.totalPage,n.rows=e.user.map((function(e){return{_id:e._id,name:e.name,email:e.email,role:e.roles.length>0?e.roles[0].role:"-"}}))}),(function(){n.stopLoading()}))}},{key:"search",value:function(){var e=this;this.presentLoading(),this.page.offset=0,"name"===this.page.searchBy?(this.page.name=this.searchText,this.page.email=""):"email"===this.page.searchBy&&(this.page.name="",this.page.email=this.searchText),this.userManagementService.getUserList(this.page).subscribe((function(n){e.stopLoading(),e.page.offset=n.offset,e.page.totalUser=n.totalUser,e.page.totalPage=n.totalPage,e.rows=n.user.map((function(e){return{_id:e._id,name:e.name,email:e.email,role:e.roles.length>0?e.roles[0].role:"-"}}))}),(function(){e.stopLoading()}))}},{key:"presentLoading",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadingController.create({cssClass:"my-custom-class",message:"Searching users..."});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"stopLoading",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.loadingController.dismiss();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onSort",value:function(e){var n=this;this.page.orderBy=e.column.name.toLowerCase(),this.page.isAscending="asc"===e.newValue,this.userManagementService.getUserList(this.page).subscribe((function(e){n.page.offset=e.offset,n.page.totalUser=e.totalUser,n.page.totalPage=e.totalPage,n.rows=e.user.map((function(e){return{_id:e._id,name:e.name,email:e.email,role:e.roles.length>0?e.roles[0].role:"-"}}))}))}},{key:"onSelect",value:function(e){_objectDestructuringEmpty(e)}},{key:"openCreateUserModal",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalController.create({cssClass:"custom-lg-modal",component:h});case 2:return n=e.sent,e.next=5,n.present();case 5:return e.next=7,n.onWillDismiss().then((function(){t.ngOnInit()}));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"deleteUser",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({cssClass:"my-custom-class",header:"Permenantly delete ".concat(e.name,"'s account"),message:"Are you sure you want to delete this account? This action cannot be undone.",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:function(){o.userManagementService.deleteUser(e).subscribe((function(){return Object(c.a)(o,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({header:"Edit ".concat(e.name,"'s account success!"),color:"success",duration:2e3});case 2:n.sent.present(),this.ngOnInit();case 4:case"end":return n.stop()}}),n,this)})))}),(function(){return Object(c.a)(o,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.toastController.create({header:"Fail to edit ".concat(e.name,"'s account!"),color:"danger",duration:2e3});case 2:n.sent.present(),this.ngOnInit();case 4:case"end":return n.stop()}}),n,this)})))}))}}]});case 2:return t=n.sent,n.next=5,t.present();case 5:case"end":return n.stop()}}),n,this)})))}}]),e}(),v.\u0275fac=function(e){return new(e||v)(u.Mb(g.a),u.Mb(b.a),u.Mb(a.R),u.Mb(a.a),u.Mb(a.Y),u.Mb(a.Q))},v.\u0275cmp=u.Gb({type:v,selectors:[["app-user-management"]],hostBindings:function(e,n){1&e&&u.Zb("resize",(function(e){return n.onResize(e)}),!1,u.qc)},decls:42,vars:27,consts:[[3,"pageAtTop"],[3,"fullscreen","scrollEvents","ionScroll"],["size","0","size-md","1"],["size","12","size-md","10"],["lines","none"],["slot","end"],["color","primary","fill","solid",3,"click"],["name","person-add","slot","start"],["size","9","size-md","5"],["showCancelButton","never","animated","","placeholder","Enter your search",3,"ngModel","keyup.enter","ngModelChange"],["size","1","size-md","1"],["color","primary","fill","solid",2,"margin-top","10px",3,"click"],["name","search-outline"],["size","12","size-md","4"],["interface","popover",3,"ngModel","ngModelChange"],["value","name"],["value","email"],["lines","none","color","light",4,"ngFor","ngForOf"],["rowHeight","auto",1,"material",2,"margin-bottom","70vh",3,"rows","columns","columnMode","headerHeight","footerHeight","externalPaging","count","offset","limit","scrollbarH","selected","selectionType","externalSorting","page","select","sort"],[3,"innerWidth"],["lines","none","color","light"],["color","danger","fill","solid",3,"click"],["name","trash","slot","start"]],template:function(e,n){1&e&&(u.Rb(0,"ion-header"),u.Nb(1,"app-header",0),u.Qb(),u.Rb(2,"ion-content",1),u.Zb("ionScroll",(function(e){return n.onScroll(e)})),u.Rb(3,"ion-grid"),u.Rb(4,"ion-row"),u.Nb(5,"ion-col",2),u.Rb(6,"ion-col",3),u.Rb(7,"ion-item",4),u.Rb(8,"ion-buttons",5),u.Rb(9,"ion-button",6),u.Zb("click",(function(){return n.openCreateUserModal()})),u.Nb(10,"ion-icon",7),u.Rb(11,"ion-label"),u.Ac(12,"Add User"),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Nb(13,"ion-col",2),u.Qb(),u.Rb(14,"ion-row"),u.Nb(15,"ion-col",2),u.Rb(16,"ion-col",8),u.Rb(17,"ion-searchbar",9),u.Zb("keyup.enter",(function(){return n.search()}))("ngModelChange",(function(e){return n.searchText=e})),u.Qb(),u.Qb(),u.Rb(18,"ion-col",10),u.Rb(19,"ion-button",11),u.Zb("click",(function(){return n.search()})),u.Nb(20,"ion-icon",12),u.Qb(),u.Qb(),u.Rb(21,"ion-col",13),u.Rb(22,"ion-item"),u.Rb(23,"ion-label"),u.Ac(24,"Search by"),u.Qb(),u.Rb(25,"ion-select",14),u.Zb("ngModelChange",(function(e){return n.page.searchBy=e})),u.Rb(26,"ion-select-option",15),u.Ac(27,"Name"),u.Qb(),u.Rb(28,"ion-select-option",16),u.Ac(29,"Email"),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Nb(30,"ion-col",2),u.Qb(),u.Rb(31,"ion-row"),u.Nb(32,"ion-col",2),u.Rb(33,"ion-col",3),u.yc(34,p,8,1,"ion-item",17),u.Qb(),u.Nb(35,"ion-col",2),u.Qb(),u.Rb(36,"ion-row"),u.Nb(37,"ion-col",2),u.Rb(38,"ion-col",3),u.Rb(39,"ngx-datatable",18),u.Zb("page",(function(e){return n.setPage(e)}))("select",(function(e){return n.onSelect(e)}))("sort",(function(e){return n.onSort(e)})),u.Qb(),u.Qb(),u.Nb(40,"ion-col",2),u.Qb(),u.Qb(),u.Nb(41,"app-footer",19),u.Qb()),2&e&&(u.Ab(1),u.ic("pageAtTop",n.pageAtTop),u.Ab(1),u.ic("fullscreen",!0)("scrollEvents",!0),u.Ab(15),u.ic("ngModel",n.searchText),u.Ab(8),u.ic("ngModel",n.page.searchBy),u.Ab(9),u.ic("ngForOf",n.selected),u.Ab(5),u.ic("rows",n.rows)("columns",u.mc(23,M,u.kc(20,w),u.kc(21,Q),u.kc(22,y)))("columnMode","force")("headerHeight",50)("footerHeight",50)("externalPaging",!0)("count",n.page.totalUser)("offset",n.page.offset)("limit",n.page.limit)("scrollbarH",!0)("selected",n.selected)("selectionType","single")("externalSorting",!0),u.Ab(2),u.ic("innerWidth",n.innerWidth))},directives:[a.q,d.a,a.n,a.p,a.C,a.m,a.t,a.f,a.e,a.r,a.u,a.D,a.X,i.e,i.h,a.E,a.W,a.F,r.k,m.c,f.a,a.K],styles:[""]}),v)}],A=((R=function e(){_classCallCheck(this,e)}).\u0275mod=u.Kb({type:R}),R.\u0275inj=u.Jb({factory:function(e){return new(e||R)},imports:[[s.i.forChild(k)],s.i]}),R),x=t("iWjc"),S=((C=function e(){_classCallCheck(this,e)}).\u0275mod=u.Kb({type:C}),C.\u0275inj=u.Jb({factory:function(e){return new(e||C)},imports:[[r.c,i.a,a.O,A,m.d,x.a]]}),C)}}]);