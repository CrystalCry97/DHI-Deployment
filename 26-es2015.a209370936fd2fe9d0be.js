(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{yQt4:function(t,e,i){"use strict";i.r(e),i.d(e,"SearchPageModule",(function(){return P}));var n=i("ofXK"),o=i("3Pt+"),a=i("TEn/"),r=i("tyNb"),s=i("UTcu"),c=i("fNvp"),l=i("mrSG"),b=i("dfks"),g=i("Buy9"),h=i("fXoL"),p=i("KJTt"),d=i("QY0l"),u=i("Yhfc"),m=i("2MiI"),f=i("lDzL"),y=i("LmEr");function A(t,e){if(1&t&&h.Nb(0,"span",44),2&t){const t=h.bc().value;h.ic("innerHTML",t,h.sc)}}function R(t,e){if(1&t){const t=h.Sb();h.Rb(0,"span",45),h.Zb("click",(function(){h.rc(t);const e=h.bc().row;return h.bc(2).navigateToArticle(e.link)})),h.Ac(1),h.Qb()}if(2&t){const t=h.bc().value;h.ic("innerHTML",t,h.sc),h.Ab(1),h.Cc(" ",t," ")}}function v(t,e){if(1&t){const t=h.Sb();h.Rb(0,"span"),h.Rb(1,"ion-list"),h.Rb(2,"ion-item"),h.Rb(3,"ion-button",46),h.Zb("click",(function(){h.rc(t);const e=h.bc().row;return h.bc(2).openAbstract(e)})),h.Nb(4,"ion-icon",47),h.Qb(),h.Rb(5,"ion-button",46),h.Zb("click",(function(){h.rc(t);const e=h.bc().row;return h.bc(2).navigateToAnnotation(e._id)})),h.Nb(6,"ion-icon",48),h.Qb(),h.Qb(),h.Rb(7,"ion-chip",49),h.Rb(8,"ion-label"),h.Rb(9,"small"),h.Ac(10),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb()}if(2&t){const t=h.bc().row;h.Ab(7),h.ic("color",t.approved>0?"success":"warning"),h.Ab(3),h.Cc("",t.approved," annotation")}}function Q(t,e){if(1&t&&(h.yc(0,A,1,1,"span",41),h.yc(1,R,2,2,"span",42),h.yc(2,v,11,2,"span",43)),2&t){const t=h.bc().$implicit;h.ic("ngIf","Actions"!==t.name&&"Title"!==t.name),h.Ab(1),h.ic("ngIf","Actions"!==t.name&&"Title"===t.name),h.Ab(1),h.ic("ngIf","Actions"===t.name)}}function w(t,e){1&t&&(h.Rb(0,"ngx-datatable-column",39),h.yc(1,Q,3,3,"ng-template",40),h.Qb()),2&t&&h.ic("name",e.$implicit.name)("width",200)}const C=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o,a){this.pagePositionService=t,this.articleService=e,this.modalController=i,this.loadingController=n,this.tokenHelper=o,this.toastController=a,this.pageAtTop=!0,this.page=new b.a,this.rows=new Array,this.selected=[],this.searchText="",this.columns=[{name:"Title"},{name:"Category"},{name:"Year"},{name:"Actions"}],this.page.limit=10}ngOnInit(){this.innerWidth=window.innerWidth}onResize(t){this.innerWidth=window.innerWidth}onScroll(t){this.pageAtTop=this.pagePositionService.isPageAtTop(t)}highlightFilter(t,e){let i=t;try{if(t&&e&&void 0!==typeof t&&void 0!==typeof e&&(t=t.toString().trim(),(e=e.toString().trim()).length>0)){let i=(e=e.replace(",","")).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");i=i.split(" ").filter(t=>t.length>0).join("|");let n=new RegExp(i,"gi");t=t.replace(n,t=>`<b>${t}</b>`)}}catch(n){return console.error(n),i}return t}setPage(t){this.presentLoading(),this.page.offset=t.offset,this.articleService.getArticleList(this.page).subscribe(t=>{this.stopLoading(),this.page.offset=t.offset,this.page.totalArticles=t.totalArticles,this.page.totalPage=t.totalPage,this.rows=t.articles.map(t=>({_id:t._id,title:this.highlightFilter(t.title,this.searchText),category:t.category,year:t.year,abstract:t.abstract,link:t.link,doi:t.doi,pending:this.getAnnotationCount(t.annotations_data,"pending"),approved:this.getAnnotationCount(t.annotations_data,"approved")}))},()=>{this.stopLoading()})}search(t){this.presentLoading();const e=t?t.target.value:this.searchText;this.page.offset=0,"title"===this.page.searchBy?(this.page.textSearch=!1,this.page.title=e,this.page.category="",this.page.year="",this.page.abstract=""):"category"===this.page.searchBy?(this.page.textSearch=!1,this.page.title="",this.page.category=e,this.page.year="",this.page.abstract=""):"year"===this.page.searchBy?(this.page.textSearch=!1,this.page.title="",this.page.category="",this.page.year=e,this.page.abstract=""):"abstract"===this.page.searchBy?(this.page.textSearch=!1,this.page.title="",this.page.category="",this.page.year="",this.page.abstract=e):"text"===this.page.searchBy&&(this.page.textSearch=!0,this.page.title=e,this.page.category="",this.page.year="",this.page.abstract=""),this.articleService.getArticleList(this.page).subscribe(t=>{this.stopLoading(),this.page.offset=t.offset,this.page.totalArticles=t.totalArticles,this.page.totalPage=t.totalPage,this.rows=t.articles.map(t=>({_id:t._id,title:this.highlightFilter(t.title,this.searchText),category:t.category,year:t.year,abstract:t.abstract,link:t.link,doi:t.doi,pending:this.getAnnotationCount(t.annotations_data,"pending"),approved:this.getAnnotationCount(t.annotations_data,"approved")}))},()=>{this.stopLoading()})}presentLoading(){return Object(l.a)(this,void 0,void 0,(function*(){const t=yield this.loadingController.create({cssClass:"my-custom-class",message:"Searching articles..."});yield t.present()}))}stopLoading(){return Object(l.a)(this,void 0,void 0,(function*(){this.loadingController.dismiss()}))}onSort(t){this.page.orderBy=t.column.name.toLowerCase(),this.page.isAscending="asc"===t.newValue,this.articleService.getArticleList(this.page).subscribe(t=>{this.page.offset=t.offset,this.page.totalArticles=t.totalArticles,this.page.totalPage=t.totalPage,this.rows=t.articles.map(t=>({_id:t._id,title:this.highlightFilter(t.title,this.searchText),category:t.category,year:t.year,abstract:t.abstract,link:t.link,doi:t.doi,pending:this.getAnnotationCount(t.annotations_data,"pending"),approved:this.getAnnotationCount(t.annotations_data,"approved")}))})}getAnnotationCount(t,e){const i=t.length>0?t.find(t=>t._id==e):null;return null==i?0:i.total}openAbstract(t){return Object(l.a)(this,void 0,void 0,(function*(){const e=yield this.modalController.create({cssClass:"custom-lg-modal ",component:g.a,componentProps:{article:t,searchKey:this.searchText}});return yield e.present()}))}navigateToArticle(t){window.open(t)}changeResultPerPage(t){this.page.limit=t.detail.value,this.search(!1)}navigateToAnnotation(t){return Object(l.a)(this,void 0,void 0,(function*(){this.tokenHelper.isTokensExist()?window.open("/#/search/annotation/"+t):(yield this.toastController.create({header:"Sorry, please login or register first to access this feature.",color:"warning",duration:5e3})).present()}))}}return t.\u0275fac=function(e){return new(e||t)(h.Mb(p.a),h.Mb(d.a),h.Mb(a.R),h.Mb(a.Q),h.Mb(u.a),h.Mb(a.Y))},t.\u0275cmp=h.Gb({type:t,selectors:[["app-search"]],hostBindings:function(t,e){1&t&&h.Zb("resize",(function(t){return e.onResize(t)}),!1,h.qc)},decls:80,vars:18,consts:[[3,"pageAtTop"],[3,"fullscreen","scrollEvents","ionScroll"],["id","container"],["id","navi"],[1,"circle-1"],["id","infoi"],[1,"ion-no-padding","page-height","ion-margin"],["size","1"],["size","10","size-lg","6"],[1,"home-title"],[1,"home-subtitle"],["size","0","size-md","1"],["size","10","size-md","9"],["id","sbar","showCancelButton","never","animated","","placeholder","Enter your search",3,"ngModel","keyup.enter","ngModelChange"],["size","2","size-md","2"],["color","primary","fill","solid",2,"margin-top","10px",3,"click"],["name","search-outline"],[3,"ngModel","ngModelChange"],[2,"margin-left","7vw","margin-right","7vw"],["lines","none","color","none"],["slot","start","mode","md","item-left","","value","text"],["slot","start","mode","md","item-left","","value","title"],["slot","start","mode","md","item-left","","value","category"],["slot","start","mode","md","item-left","","value","year"],["slot","start","mode","md","item-left","","value","abstract"],[2,"margin","5px 5px"],["size","5","size-md","7"],["lines","none"],[2,"font-size","12px","color","grey"],["size","7","size-md","3"],["interface","popover","value","10",2,"font-size","12px","color","grey",3,"ionChange"],["value","10"],["value","25"],["value","50"],["value","100"],["size","12","size-md","10"],["rowHeight","auto",1,"material",2,"margin-bottom","20vh",3,"rows","columnMode","headerHeight","footerHeight","externalPaging","count","offset","limit","scrollbarH","externalSorting","page","sort"],[3,"name","width",4,"ngFor","ngForOf"],[3,"innerWidth"],[3,"name","width"],["ngx-datatable-cell-template",""],[3,"innerHTML",4,"ngIf"],["class","article-title","src","#",3,"innerHTML","click",4,"ngIf"],[4,"ngIf"],[3,"innerHTML"],["src","#",1,"article-title",3,"innerHTML","click"],["shape","round","fill","clear",3,"click"],["name","information-circle","color","tertiary"],["name","bookmarks","color","tertiary"],["disabled","true","outline","true",3,"color"]],template:function(t,e){1&t&&(h.Rb(0,"ion-header"),h.Nb(1,"app-header",0),h.Qb(),h.Rb(2,"ion-content",1),h.Zb("ionScroll",(function(t){return e.onScroll(t)})),h.Rb(3,"div",2),h.Rb(4,"div",3),h.Nb(5,"span",4),h.Qb(),h.Rb(6,"div",5),h.Rb(7,"ion-grid",6),h.Rb(8,"ion-row"),h.Nb(9,"ion-col",7),h.Rb(10,"ion-col",8),h.Rb(11,"h1",9),h.Ac(12,"Search"),h.Qb(),h.Rb(13,"p",10),h.Ac(14,"Let's start searching!"),h.Qb(),h.Qb(),h.Qb(),h.Rb(15,"ion-row"),h.Nb(16,"ion-col",11),h.Rb(17,"ion-col",12),h.Rb(18,"ion-searchbar",13),h.Zb("keyup.enter",(function(t){return e.search(t)}))("ngModelChange",(function(t){return e.searchText=t})),h.Qb(),h.Qb(),h.Rb(19,"ion-col",14),h.Rb(20,"ion-button",15),h.Zb("click",(function(){return e.search(!1)})),h.Nb(21,"ion-icon",16),h.Qb(),h.Qb(),h.Qb(),h.Rb(22,"ion-radio-group",17),h.Zb("ngModelChange",(function(t){return e.page.searchBy=t})),h.Rb(23,"ion-grid",18),h.Rb(24,"ion-row"),h.Rb(25,"ion-col"),h.Rb(26,"ion-item",19),h.Rb(27,"ion-label"),h.Ac(28,"Search by:"),h.Qb(),h.Qb(),h.Qb(),h.Rb(29,"ion-col"),h.Rb(30,"ion-item",19),h.Rb(31,"ion-label"),h.Ac(32,"Text"),h.Qb(),h.Nb(33,"ion-radio",20),h.Qb(),h.Qb(),h.Rb(34,"ion-col"),h.Rb(35,"ion-item",19),h.Rb(36,"ion-label"),h.Ac(37,"Title"),h.Qb(),h.Nb(38,"ion-radio",21),h.Qb(),h.Qb(),h.Rb(39,"ion-col"),h.Rb(40,"ion-item",19),h.Rb(41,"ion-label"),h.Ac(42,"Category"),h.Qb(),h.Nb(43,"ion-radio",22),h.Qb(),h.Qb(),h.Rb(44,"ion-col"),h.Rb(45,"ion-item",19),h.Rb(46,"ion-label"),h.Ac(47,"Year"),h.Qb(),h.Nb(48,"ion-radio",23),h.Qb(),h.Qb(),h.Rb(49,"ion-col"),h.Rb(50,"ion-item",19),h.Rb(51,"ion-label"),h.Ac(52,"Abstract"),h.Qb(),h.Nb(53,"ion-radio",24),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Rb(54,"ion-row",25),h.Nb(55,"ion-col",11),h.Rb(56,"ion-col",26),h.Rb(57,"ion-item",27),h.Rb(58,"ion-label",28),h.Ac(59),h.Qb(),h.Qb(),h.Qb(),h.Rb(60,"ion-col",29),h.Rb(61,"ion-item",27),h.Rb(62,"ion-label",28),h.Ac(63,"Results per Page"),h.Qb(),h.Rb(64,"ion-select",30),h.Zb("ionChange",(function(t){return e.changeResultPerPage(t)})),h.Rb(65,"ion-select-option",31),h.Ac(66,"10"),h.Qb(),h.Rb(67,"ion-select-option",32),h.Ac(68,"25"),h.Qb(),h.Rb(69,"ion-select-option",33),h.Ac(70,"50"),h.Qb(),h.Rb(71,"ion-select-option",34),h.Ac(72,"100"),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Rb(73,"ion-row"),h.Nb(74,"ion-col",11),h.Rb(75,"ion-col",35),h.Rb(76,"ngx-datatable",36),h.Zb("page",(function(t){return e.setPage(t)}))("sort",(function(t){return e.onSort(t)})),h.yc(77,w,2,2,"ngx-datatable-column",37),h.Qb(),h.Qb(),h.Nb(78,"ion-col",11),h.Qb(),h.Qb(),h.Nb(79,"app-footer",38),h.Qb(),h.Qb(),h.Qb()),2&t&&(h.Ab(1),h.ic("pageAtTop",e.pageAtTop),h.Ab(1),h.ic("fullscreen",!0)("scrollEvents",!0),h.Ab(16),h.ic("ngModel",e.searchText),h.Ab(4),h.ic("ngModel",e.page.searchBy),h.Ab(37),h.Cc("",e.page.totalArticles," total"),h.Ab(17),h.ic("rows",e.rows)("columnMode","force")("headerHeight",50)("footerHeight",50)("externalPaging",!0)("count",e.page.totalArticles)("offset",e.page.offset)("limit",e.page.limit)("scrollbarH",!0)("externalSorting",!0),h.Ab(1),h.ic("ngForOf",e.columns),h.Ab(2),h.ic("innerWidth",e.innerWidth))},directives:[a.q,m.a,a.n,a.p,a.C,a.m,a.D,a.X,o.e,o.h,a.e,a.r,a.A,a.W,a.t,a.u,a.z,a.U,a.E,a.F,f.c,n.k,y.a,f.b,f.a,n.l,a.v,a.l],styles:[".circle-1[_ngcontent-%COMP%]{right:-434px;top:-554px;height:868px;width:868px}.circle-1[_ngcontent-%COMP%], .circle-2[_ngcontent-%COMP%]{position:absolute;background-color:#bbb;border-radius:50%;display:inline-block;background:#6078ea;background:linear-gradient(201deg,#6078ea,#17ead9)}.circle-2[_ngcontent-%COMP%]{left:-200px;top:1200px;height:500px;width:500px}#container[_ngcontent-%COMP%]{position:relative}#infoi[_ngcontent-%COMP%], #navi[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}#infoi[_ngcontent-%COMP%]{z-index:1}.page-height[_ngcontent-%COMP%]{min-height:100vh}.home-title[_ngcontent-%COMP%]{font-size:4rem;white-space:pre-wrap;margin-top:50px}.home-subtitle[_ngcontent-%COMP%]{font-size:1.5rem!important}.article-title[_ngcontent-%COMP%]{cursor:pointer}.article-title[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}),t})()},{path:"annotation/:article-id",canActivate:[s.a,c.a],data:{registeredUserOnly:!0},loadChildren:()=>Promise.all([i.e(3),i.e(20)]).then(i.bind(null,"3zE6")).then(t=>t.AnnotationPublicPageModule)}];let x=(()=>{class t{}return t.\u0275mod=h.Kb({type:t}),t.\u0275inj=h.Jb({factory:function(e){return new(e||t)},imports:[[r.i.forChild(C)],r.i]}),t})();var M=i("iWjc");let P=(()=>{class t{}return t.\u0275mod=h.Kb({type:t}),t.\u0275inj=h.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,o.a,a.O,x,f.d,M.a]]}),t})()}}]);